<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>atomes: calc/calc.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../atomes.svg"/></td>
  <td id="projectalign">
   <div id="projectname">atomes<span id="projectnumber">&#160;1.1.14</span>
   </div>
   <div id="projectbrief">atomes: an atomic scale modeling tool box</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d1/dcc/calc_8c_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">calc.c</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d1/dcc/calc_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/* This file is part of the &#39;atomes&#39; software</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"></span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">&#39;atomes&#39; is free software: you can redistribute it and/or modify it under the terms</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">of the GNU Affero General Public License as published by the Free Software Foundation,</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"></span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">&#39;atomes&#39; is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">See the GNU General Public License for more details.</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"></span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">You should have received a copy of the GNU Affero General Public License along with &#39;atomes&#39;.</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">If not, see &lt;https://www.gnu.org/licenses/&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"></span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">Copyright (C) 2022-2024 by CNRS and University of Strasbourg */</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment">/*</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="comment">* This file: &#39;calc.c&#39;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment">*</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="comment">* Contains:</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="comment">*</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="comment"></span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="comment"> - Callbacks used in by the molecular dynamics calculation assistant</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="comment"> - Atom selection structure manipulation tools</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="comment"> - The initialization of the assistants</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="comment"></span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="comment">*</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="comment">* List of functions:</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment"></span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment">  void field_question (gchar * question, GCallback handler, gpointer data);</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment">  void unselect_all_atoms (glwin * view);</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment">  void restore_ogl_selection (glwin * view);</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment">  void preserve_ogl_selection (glwin * view);</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment"></span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="comment">  G_MODULE_EXPORT void confirm_selection (GtkDialog * dialog, gint response_id, gpointer data);</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="comment">  G_MODULE_EXPORT void create_field (GtkWidget * widg, gpointer data);</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment"></span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="comment">  struct atom_selection * duplicate_ogl_selection (struct atom_selection * old_sel);</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="comment"></span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="comment">*/</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &quot;<a class="code" href="../../d2/d49/global_8h.html">global.h</a>&quot;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &quot;<a class="code" href="../../d4/da9/interface_8h.html">interface.h</a>&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &quot;<a class="code" href="../../dc/d8d/project_8h.html">project.h</a>&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/d2a/glwindow_8h.html">glwindow.h</a>&quot;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#include &quot;<a class="code" href="../../dc/de3/glview_8h.html">glview.h</a>&quot;</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a2b204ad95d4a0de21e950d4550f7f4b4">   55</a></span><span class="preprocessor">#define MAXDATAQM 7</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#acc2e12098220106492acfa228eb88db0">create_classical_force_field</a> (<span class="keywordtype">int</span> p, <span class="keywordtype">int</span> f);</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ac8f82b4c47332a3ef876e2e89dd73b12">create_qm_input_file</a> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../df/df7/tab-1_8c.html#a4e1e0e72dd773439e333c84dd762a9c3">c</a>, <span class="keywordtype">int</span> p, <span class="keywordtype">int</span> s);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ad1e0bfa9ca1b6c21c619081d65b0f289">create_new_project_using_data</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="../../d6/d0f/structatom__selection.html">atom_selection</a> * selection);</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#ad81e8b625a603091b826af5886ca09e4">selected_aspec</a>;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a217a0b553ba8c460e7d5d251738016f3">num_bonds</a> (<span class="keywordtype">int</span> i);</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a9f9c174b2b52cd5d1073b6560c1dc649">num_angles</a> (<span class="keywordtype">int</span> i);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a67589644451994ac2eb22ce3ba207444">num_dihedrals</a> (<span class="keywordtype">int</span> i);</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="keyword">extern</span> <span class="keyword">struct </span><a class="code hl_struct" href="../../dd/d4c/structselatom.html">selatom</a> * <a class="code hl_function" href="../../d1/dcc/calc_8c.html#aafa54525d9b45e8fa14617a65f4e1800">new_selatom</a> (<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/d4c/structselatom.html#a024603cda52d9847e8d8df3c2e884b8c">sp</a>);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a5a8d46d83e58133452cb6922e6af24bc">   66</a></span>GtkWidget * <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a5a8d46d83e58133452cb6922e6af24bc">qm_assistant</a>;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#abda3f5a20381278953e6f3e5ae1a2d0c">   67</a></span><span class="keyword">struct </span><a class="code hl_struct" href="../../dd/dbe/structproject.html">project</a> * <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#abda3f5a20381278953e6f3e5ae1a2d0c">qm_proj</a>;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a920ced75ee5e2a83a77e0c6dbd54c1a5">   68</a></span><a class="code hl_struct" href="../../d5/dd2/structglwin.html">glwin</a> * <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a920ced75ee5e2a83a77e0c6dbd54c1a5">qm_view</a>;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#ad859a3e28c5f11c248cf9bfa24a8dd86">   69</a></span><a class="code hl_struct" href="../../df/ddc/structcoord__info.html">coord_info</a> * <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#ad859a3e28c5f11c248cf9bfa24a8dd86">qm_coord</a>;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a2359ebc78207d2253ace4fb37f9451f6">   70</a></span>GtkTextBuffer * <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a2359ebc78207d2253ace4fb37f9451f6">qmbuffer</a>[<a class="code hl_define" href="../../d1/dcc/calc_8c.html#a2b204ad95d4a0de21e950d4550f7f4b4">MAXDATAQM</a>+2];</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a65ff59350857daf2c84fac30688dc2a1">   71</a></span>gboolean <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a65ff59350857daf2c84fac30688dc2a1">force_mol</a> = FALSE;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a6eb9e6b6264fd2918d7d9d00c9c871aa">   72</a></span><span class="keywordtype">int</span> <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a6eb9e6b6264fd2918d7d9d00c9c871aa">idopt</a>;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#ad4719134658ac2407af687c7117e21af">   73</a></span><span class="keywordtype">int</span> <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#ad4719134658ac2407af687c7117e21af">icalc</a>;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a52e7dc3872878f8c40cd3523fed00c80">   74</a></span><span class="keywordtype">int</span> <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a52e7dc3872878f8c40cd3523fed00c80">ident</a>;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#ad0285ff5ba77255c59eba4c6014edd8e">   75</a></span><span class="keywordtype">int</span> <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#ad0285ff5ba77255c59eba4c6014edd8e">icomb</a>;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a2e3daf14dd237159729f6868a7a2d3c6">   77</a></span>gboolean <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a2e3daf14dd237159729f6868a7a2d3c6">selection_confirmed</a>;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a50cfa2e27c94c14e4a51d42147319ba1">   88</a></span>G_MODULE_EXPORT <span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a50cfa2e27c94c14e4a51d42147319ba1">confirm_selection</a> (GtkDialog * dialog, gint response_id, gpointer data)</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>{</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>  <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a2e3daf14dd237159729f6868a7a2d3c6">selection_confirmed</a> = (response_id == GTK_RESPONSE_YES) ? TRUE : FALSE;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>  <a class="code hl_function" href="../../d2/d49/global_8h.html#aa49ddc0195d8a595480dc10e720e0e60">destroy_this_dialog</a> (dialog);</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>}</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a16d22fb01d0c34406e63f5522d45ff34">  103</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a16d22fb01d0c34406e63f5522d45ff34">field_question</a> (gchar * question, GCallback handler, gpointer data)</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>{</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>  GtkWidget * dialog;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>  dialog = gtk_message_dialog_new (NULL, GTK_DIALOG_MODAL, GTK_MESSAGE_QUESTION, GTK_BUTTONS_YES_NO, <span class="stringliteral">&quot;Are you sure ?&quot;</span>);</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>  gtk_message_dialog_format_secondary_text (GTK_MESSAGE_DIALOG (dialog), <span class="stringliteral">&quot;%s&quot;</span>, question);</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>  gtk_window_set_title(GTK_WINDOW(dialog), <span class="stringliteral">&quot;Please confirm&quot;</span>);</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>  <a class="code hl_function" href="../../d2/d49/global_8h.html#a03865a092347f44d492015e2d96e5c1b">run_this_gtk_dialog</a> (dialog, handler, data);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>}</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a2eae4a0d274b8690e6640f96b9c5d697">  119</a></span><span class="keyword">struct </span><a class="code hl_struct" href="../../d6/d0f/structatom__selection.html">atom_selection</a> * <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a2eae4a0d274b8690e6640f96b9c5d697">duplicate_ogl_selection</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="../../d6/d0f/structatom__selection.html">atom_selection</a> * old_sel)</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>{</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../dd/d4c/structselatom.html">selatom</a> * at, * bt;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d6/d0f/structatom__selection.html">atom_selection</a> * new_sel = g_malloc0 (<span class="keyword">sizeof</span>*new_sel);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  <span class="keywordflow">if</span> (! old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>) <span class="keywordflow">return</span> new_sel;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>  new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> = old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>  at = old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#aaa83eb55c4977fffe7dc968871c68191">first</a>;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  <span class="keywordflow">for</span> (i=0; i&lt; old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>; i++)</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>  {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    <span class="keywordflow">if</span> (! i)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    {</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>      new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#aaa83eb55c4977fffe7dc968871c68191">first</a> = <a class="code hl_function" href="../../d1/dcc/calc_8c.html#aafa54525d9b45e8fa14617a65f4e1800">new_selatom</a> (at -&gt; <span class="keywordtype">id</span>, at -&gt; sp);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>      bt = new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#aaa83eb55c4977fffe7dc968871c68191">first</a>;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>      new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#afc1615d6e57c873b3ee4eed3dd6ac117">last</a> = NULL;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    }</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    {</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>      bt -&gt; next = <a class="code hl_function" href="../../d1/dcc/calc_8c.html#aafa54525d9b45e8fa14617a65f4e1800">new_selatom</a> (at -&gt; <span class="keywordtype">id</span>, at -&gt; sp);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>      bt -&gt; next -&gt; prev = bt;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>      bt = bt -&gt; next;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keywordflow">if</span> (at -&gt; next != NULL) at = at -&gt; next;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>  }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>  bt -&gt; next = NULL;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#afc1615d6e57c873b3ee4eed3dd6ac117">last</a> = bt;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>  <span class="keywordflow">if</span> (old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> &gt; 1 &amp;&amp; old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> &lt; <a class="code hl_define" href="../../dc/de3/glview_8h.html#a32c2baeed9056c3aafc347f660c812d0">MAX_IN_SELECTION</a>)</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>  {</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    i = <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a217a0b553ba8c460e7d5d251738016f3">num_bonds</a> (old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>);</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#a7c6d36b71454cf01697706b535082042">selected_bonds</a> = <a class="code hl_function" href="../../dc/d57/global_8c.html#aaf3f2fd944639e6fb28457da820d2d04">allocint</a> (i);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="keywordflow">for</span> (j=0; j&lt;i; j++)</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>      new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#a7c6d36b71454cf01697706b535082042">selected_bonds</a>[j] = old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#a7c6d36b71454cf01697706b535082042">selected_bonds</a>[j];</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    }</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <span class="keywordflow">if</span> (new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> &gt; 2)</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    {</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>      i = <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a9f9c174b2b52cd5d1073b6560c1dc649">num_angles</a> (old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>      new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#aed750c5384852e5de0e200c4b4b29c32">selected_angles</a> = <a class="code hl_function" href="../../dc/d57/global_8c.html#aaf3f2fd944639e6fb28457da820d2d04">allocint</a> (i);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>      <span class="keywordflow">for</span> (j=0; j&lt;i; j++)</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>      {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#aed750c5384852e5de0e200c4b4b29c32">selected_angles</a>[j] = old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#aed750c5384852e5de0e200c4b4b29c32">selected_angles</a>[j];</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>      }</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>      <span class="keywordflow">if</span> (new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> &gt; 3 &amp;&amp; new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a> &lt; <a class="code hl_define" href="../../dc/de3/glview_8h.html#a32c2baeed9056c3aafc347f660c812d0">MAX_IN_SELECTION</a>-10)</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>      {</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        i = <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a67589644451994ac2eb22ce3ba207444">num_dihedrals</a> (old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">selected</a>);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#a7f10a5b21c01156cc9686436860ab0bd">selected_dihedrals</a> = <a class="code hl_function" href="../../dc/d57/global_8c.html#aaf3f2fd944639e6fb28457da820d2d04">allocint</a> (i);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        <span class="keywordflow">for</span> (j=0; j&lt;i; j++)</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        {</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>          new_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#a7f10a5b21c01156cc9686436860ab0bd">selected_dihedrals</a>[j] = old_sel -&gt; <a class="code hl_variable" href="../../d6/d0f/structatom__selection.html#a7f10a5b21c01156cc9686436860ab0bd">selected_dihedrals</a>[j];</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        }</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>      }</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    }</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>  }</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>  <span class="keywordflow">return</span> new_sel;</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>}</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a4123d5a1dca7412136e98476b1fad428">  182</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a4123d5a1dca7412136e98476b1fad428">unselect_all_atoms</a> (<a class="code hl_struct" href="../../d5/dd2/structglwin.html">glwin</a> * view)</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>{</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  <span class="keywordtype">int</span> i, j, k;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../dd/dbe/structproject.html">project</a> * this_proj = <a class="code hl_function" href="../../d2/d49/global_8h.html#ab35a20e8b34f936e2eaf616b6108a25e">get_project_by_id</a> (view -&gt; <a class="code hl_variable" href="../../d2/d49/global_8h.html#a8c8175db540e27a12f44de526051712a">proj</a>);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>  <span class="keywordflow">for</span> (i=0; i&lt;2; i++)</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>  {</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <a class="code hl_function" href="../../dc/de3/glview_8h.html#ada5793f27b93c0470934ed5a59d072c0">save_all_selections</a> (view, i);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keywordflow">for</span> (j=0; j&lt;this_proj -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#ab4ae7205573977222eadd0795db193e2">steps</a>; j++)</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>      <span class="keywordflow">for</span> (k=0; k&lt;this_proj -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#a1123db0395a8a91840ac6fc353b15e48">natomes</a>; k++)</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>      {</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <span class="keywordflow">if</span> (j == view -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; <a class="code hl_variable" href="../../dc/de3/glview_8h.html#abc16e65f240ed0c8f3e876e8732c0a33">step</a>)</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        {</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>          <span class="keywordflow">if</span> (this_proj -&gt; <a class="code hl_variable" href="../../d9/d09/d__selection_8c.html#a00fd968c209562dd06305b96b8829715">atoms</a>[j][k].<a class="code hl_variable" href="../../dc/de3/glview_8h.html#a3c30182e3bb8d86d14fdd648ad481bfb">pick</a>[i])</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>          {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>            <a class="code hl_function" href="../../df/dbb/d__box_8c.html#a624f7fab23c51a3d6c022518130d5173">process_selected_atom</a> (this_proj, view, k, 0, 0, i);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>          }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        }</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>          this_proj -&gt; <a class="code hl_variable" href="../../d9/d09/d__selection_8c.html#a00fd968c209562dd06305b96b8829715">atoms</a>[j][k].pick[i] = FALSE;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        }</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>      }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    }</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <a class="code hl_function" href="../../dc/de3/glview_8h.html#ad68d7d512c6f9e7e01a70dff30be4458">update_all_selections</a> (view, i);</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  }</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>  <a class="code hl_function" href="../../d2/da2/dlp__atom_8c.html#ae7e90546f15170d3b995ba65ade46698">init_default_shaders</a> (view);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>}</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a9f622fc5c267b61dd72d0e26899933c9">  218</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a9f622fc5c267b61dd72d0e26899933c9">restore_ogl_selection</a> (<a class="code hl_struct" href="../../d5/dd2/structglwin.html">glwin</a> * view)</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>{</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  <span class="keywordtype">int</span> i, j, k, l;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../dd/dbe/structproject.html">project</a> * this_proj = <a class="code hl_function" href="../../d2/d49/global_8h.html#ab35a20e8b34f936e2eaf616b6108a25e">get_project_by_id</a> (view -&gt; <a class="code hl_variable" href="../../d2/d49/global_8h.html#a8c8175db540e27a12f44de526051712a">proj</a>);</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>  <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a4123d5a1dca7412136e98476b1fad428">unselect_all_atoms</a> (view);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>  <span class="keywordflow">for</span> (i=0; i&lt;2; i++)</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    view -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; selected[i] = <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a2eae4a0d274b8690e6640f96b9c5d697">duplicate_ogl_selection</a> (view -&gt; tmp_sel[i]);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="keywordflow">if</span> (view -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; selected[i] -&gt; selected)</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    {</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>      <span class="keyword">struct </span><a class="code hl_struct" href="../../dd/d4c/structselatom.html">selatom</a> * at = view -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; selected[i] -&gt; first;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>      <span class="keywordflow">while</span> (at)</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>      {</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        <span class="keywordflow">for</span> (j=0; j&lt;this_proj -&gt; steps; j++)</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        {</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>          this_proj -&gt; <a class="code hl_variable" href="../../d9/d09/d__selection_8c.html#a00fd968c209562dd06305b96b8829715">atoms</a>[j][at -&gt; <a class="code hl_variable" href="../../dd/d4c/structselatom.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a>].pick[i] = TRUE;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>        }</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        at = at -&gt; <a class="code hl_variable" href="../../dd/d4c/structselatom.html#a10981207e30566ddf637f09719b237e4">next</a>;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>      }</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    }</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="keywordflow">if</span> (view -&gt; stored_labels[i])</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    {</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>      <span class="keywordflow">for</span> (j=1; j&lt;view -&gt; stored_labels[i][0]; j++)</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>      {</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>        k = view -&gt; stored_labels[i][j];</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        <span class="keywordflow">for</span> (l=0; l&lt;this_proj -&gt; steps; l++) this_proj -&gt; <a class="code hl_variable" href="../../d9/d09/d__selection_8c.html#a00fd968c209562dd06305b96b8829715">atoms</a>[l][k].<a class="code hl_function" href="../../df/de9/curve_8h.html#a6433eac9d33de4a4a94383373946a4db">label</a>[i] = TRUE;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>      }</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>      g_free (view -&gt; stored_labels[i]);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>      view -&gt; stored_labels[i] = NULL;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  }</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>  <a class="code hl_function" href="../../d2/da2/dlp__atom_8c.html#ae7e90546f15170d3b995ba65ade46698">init_default_shaders</a> (view);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dc/d57/global_8c.html#aab70499bf07f4bcf8bea9073ac80ca69">check_label</a>)</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>  {</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    view -&gt; labelled = <a class="code hl_function" href="../../dc/de3/glview_8h.html#a615938e6b20ee54bb89b04ee6cc7acfa">check_label_numbers</a> (this_proj, 2);</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    <a class="code hl_function" href="../../dc/d21/glview_8c.html#a31439694040b6626b18b420754a6abf2">update</a> (view);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>  }</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>}</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#ae182ab43129fb98cd2ee0592daf3dd0f">  264</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ae182ab43129fb98cd2ee0592daf3dd0f">preserve_ogl_selection</a> (<a class="code hl_struct" href="../../d5/dd2/structglwin.html">glwin</a> * view)</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>{</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>  <span class="keywordtype">int</span> h, i, j, k, l;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../dd/dbe/structproject.html">project</a> * this_proj = <a class="code hl_function" href="../../d2/d49/global_8h.html#ab35a20e8b34f936e2eaf616b6108a25e">get_project_by_id</a> (view -&gt; <a class="code hl_variable" href="../../d2/d49/global_8h.html#a8c8175db540e27a12f44de526051712a">proj</a>);</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>  h = view -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; <a class="code hl_variable" href="../../dc/de3/glview_8h.html#abc16e65f240ed0c8f3e876e8732c0a33">step</a>;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  k = 0;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>  <span class="keywordflow">for</span> (i=0; i&lt;2; i++)</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>  {</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    view -&gt; tmp_sel[i] = <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a2eae4a0d274b8690e6640f96b9c5d697">duplicate_ogl_selection</a> (view -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; selected[i]);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    <span class="keywordflow">for</span> (j=0; j&lt;2; j++)</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>      <span class="keywordflow">if</span> (j &amp;&amp; k)</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      {</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        view -&gt; stored_labels[i] = <a class="code hl_function" href="../../dc/d57/global_8c.html#aaf3f2fd944639e6fb28457da820d2d04">allocint</a>(k+1);</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        view -&gt; stored_labels[i][0] = k+1;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>      }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>      k = j;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>      <span class="keywordflow">for</span> (l=0; l&lt;this_proj -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#a1123db0395a8a91840ac6fc353b15e48">natomes</a>; l++)</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>      {</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <span class="keywordflow">if</span> (this_proj -&gt; <a class="code hl_variable" href="../../d9/d09/d__selection_8c.html#a00fd968c209562dd06305b96b8829715">atoms</a>[h][l].<a class="code hl_function" href="../../df/de9/curve_8h.html#a6433eac9d33de4a4a94383373946a4db">label</a>[i])</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        {</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>          <span class="keywordflow">if</span> (j)</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>          {</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            view -&gt; stored_labels[i][k] = l;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>            this_proj -&gt; <a class="code hl_variable" href="../../d9/d09/d__selection_8c.html#a00fd968c209562dd06305b96b8829715">atoms</a>[h][l].label[i] = FALSE;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>          }</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>          k ++;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        }</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>      }</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    }</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>  }</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>  <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a4123d5a1dca7412136e98476b1fad428">unselect_all_atoms</a> (view);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>}</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span><span class="keyword">extern</span> <span class="keywordtype">char</span> * <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a94c2e02b8f44a8ec4db04e80f51fc91f">input_types</a>[<a class="code hl_define" href="../../da/d7e/glwin_8h.html#ae244fd7da54cffb995fdf4c38a4213c0">NINPUTS</a>];</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno"><a class="line" href="../../d1/dcc/calc_8c.html#a56dc4992a0fe143884bb1ac37e2ff029">  308</a></span>G_MODULE_EXPORT <span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a56dc4992a0fe143884bb1ac37e2ff029">create_field</a> (GtkWidget * widg, gpointer data)</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>{</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>  <a class="code hl_struct" href="../../df/d46/structtint.html">tint</a> * the_data = (<a class="code hl_struct" href="../../df/d46/structtint.html">tint</a> *)data;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>  <span class="keywordtype">int</span> p = the_data -&gt; <a class="code hl_variable" href="../../df/df7/tab-1_8c.html#aa4c2a5552e9bc49b1816ff532f558c74">a</a>;</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  <span class="keywordtype">int</span> t = the_data -&gt; <a class="code hl_variable" href="../../df/df7/tab-1_8c.html#a148e3876077787926724625411d6e7a9">b</a>;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>  <span class="comment">// if a selection was made preserve it</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>  <a class="code hl_function" href="../../d2/d49/global_8h.html#a4f4f25a62fee0705bd9a89a784aa8fc8">opengl_project_changed</a> (p);</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>  <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ae182ab43129fb98cd2ee0592daf3dd0f">preserve_ogl_selection</a> (<a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#aff9d071e0c309d1a7871e5277d86fed2">modelgl</a>);</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>  <a class="code hl_function" href="../../dc/d21/glview_8c.html#a31439694040b6626b18b420754a6abf2">update</a> (<a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#aff9d071e0c309d1a7871e5277d86fed2">modelgl</a>);</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span> </div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#ab4ae7205573977222eadd0795db193e2">steps</a> &gt; 1)</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  {</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    gchar * info = g_strdup_printf (<span class="stringliteral">&quot; %s contains %d different sets of atomic coordinates. \n&quot;</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>                                    <span class="stringliteral">&quot; Please select the one to use to create the input file(s) \n&quot;</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>                                    <span class="stringliteral">&quot; Note that a new project will be generated for that purpose. \n&quot;</span>,</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>                                    <a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#a5ac083a645d964373f022d03df4849c8">name</a>,</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>                                    <a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#ab4ae7205573977222eadd0795db193e2">steps</a>);</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <span class="comment">// preserve parameters</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="keywordtype">int</span> tmp_s = <a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#aff9d071e0c309d1a7871e5277d86fed2">modelgl</a> -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; <a class="code hl_variable" href="../../dc/de3/glview_8h.html#abc16e65f240ed0c8f3e876e8732c0a33">step</a>;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../df/dbb/d__measures_8c.html#a2dcd3a3d62ba699dc89a04a938edf68e">tmp_a</a> = <a class="code hl_variable" href="../../dc/d57/global_8c.html#a486cae79d3213edf7d5888ec50eef097">activep</a>;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <span class="keywordtype">int</span> tmp_v = <a class="code hl_variable" href="../../dc/d57/global_8c.html#a860606c6c739700a56d9ef559ab4d3a1">activev</a>;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    <a class="code hl_struct" href="../../df/d46/structtint.html">tint</a> t_data;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    t_data.<a class="code hl_variable" href="../../df/d46/structtint.html#aa4c2a5552e9bc49b1816ff532f558c74">a</a> = p;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    t_data.<a class="code hl_variable" href="../../df/d46/structtint.html#a148e3876077787926724625411d6e7a9">b</a> = <a class="code hl_function" href="../../dd/dda/interface_8c.html#a17792c1207a0e96767342a0f8fce1d40">iask</a> (info, <span class="stringliteral">&quot;Enter the selected MD step: &quot;</span>, 2+<a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#ab4ae7205573977222eadd0795db193e2">steps</a>, <a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#aff9d071e0c309d1a7871e5277d86fed2">modelgl</a> -&gt; win);</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    t_data.<a class="code hl_variable" href="../../df/d46/structtint.html#a4e1e0e72dd773439e333c84dd762a9c3">c</a> = 1;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    g_free (info);</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="comment">// then change the MD step and select all atoms</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#aff9d071e0c309d1a7871e5277d86fed2">modelgl</a> -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; <a class="code hl_variable" href="../../dc/de3/glview_8h.html#abc16e65f240ed0c8f3e876e8732c0a33">step</a> = t_data.<a class="code hl_variable" href="../../df/d46/structtint.html#a148e3876077787926724625411d6e7a9">b</a>;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#ad81e8b625a603091b826af5886ca09e4">selected_aspec</a> = -1;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span><span class="preprocessor">#ifdef GTK4</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>   <a class="code hl_function" href="../../d2/d49/global_8h.html#ab20acc15a1a5572b6a6d2ad176f82b96">select_unselect_atoms</a> (NULL, NULL, &amp; t_data);</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <a class="code hl_function" href="../../d2/d49/global_8h.html#ab20acc15a1a5572b6a6d2ad176f82b96">select_unselect_atoms</a> (NULL, &amp; t_data);</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    <span class="comment">// create new project with selection</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a65ff59350857daf2c84fac30688dc2a1">force_mol</a> = TRUE;</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ad1e0bfa9ca1b6c21c619081d65b0f289">create_new_project_using_data</a> (<a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#aff9d071e0c309d1a7871e5277d86fed2">modelgl</a> -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; selected[0]);</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    <a class="code hl_variable" href="../../d1/dcc/calc_8c.html#a65ff59350857daf2c84fac30688dc2a1">force_mol</a> = FALSE;</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    <a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#aff9d071e0c309d1a7871e5277d86fed2">modelgl</a> -&gt; anim -&gt; last -&gt; <a class="code hl_variable" href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a> -&gt; <a class="code hl_variable" href="../../dc/de3/glview_8h.html#abc16e65f240ed0c8f3e876e8732c0a33">step</a> = tmp_s;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    <a class="code hl_function" href="../../d1/dcc/calc_8c.html#a9f622fc5c267b61dd72d0e26899933c9">restore_ogl_selection</a> (<a class="code hl_variable" href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a> -&gt; <a class="code hl_variable" href="../../dd/dbe/structproject.html#aff9d071e0c309d1a7871e5277d86fed2">modelgl</a>);</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    <span class="comment">// Set the new project to be use for input creation</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    p = <a class="code hl_variable" href="../../dc/d57/global_8c.html#a486cae79d3213edf7d5888ec50eef097">activep</a>;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ae182ab43129fb98cd2ee0592daf3dd0f">preserve_ogl_selection</a> (<a class="code hl_variable" href="../../d2/d49/global_8h.html#a0ecd095d66ead4cfff3bca52e44c65d7">active_glwin</a>);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    <span class="comment">// restore old active project</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <a class="code hl_function" href="../../dc/d8d/project_8h.html#a81de550dd737cabebc1643a1e307ab8d">active_project_changed</a> (<a class="code hl_variable" href="../../df/dbb/d__measures_8c.html#a2dcd3a3d62ba699dc89a04a938edf68e">tmp_a</a>);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    <a class="code hl_function" href="../../d2/d49/global_8h.html#a4f4f25a62fee0705bd9a89a784aa8fc8">opengl_project_changed</a> (tmp_v);</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>  }</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span> </div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>  <span class="keywordflow">switch</span> (t)</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>  {</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>      <span class="comment">// DLPOLY</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      <a class="code hl_function" href="../../d1/dcc/calc_8c.html#acc2e12098220106492acfa228eb88db0">create_classical_force_field</a> (p, 0);</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>      <span class="comment">// LAMMPS</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>      <a class="code hl_function" href="../../d1/dcc/calc_8c.html#acc2e12098220106492acfa228eb88db0">create_classical_force_field</a> (p, 1);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>      <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ac8f82b4c47332a3ef876e2e89dd73b12">create_qm_input_file</a> (0, p, 0);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>      <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ac8f82b4c47332a3ef876e2e89dd73b12">create_qm_input_file</a> (1, p, 0);</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>      <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ac8f82b4c47332a3ef876e2e89dd73b12">create_qm_input_file</a> (0, p, 1);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="keywordflow">case</span> 5:</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>      <a class="code hl_function" href="../../d1/dcc/calc_8c.html#ac8f82b4c47332a3ef876e2e89dd73b12">create_qm_input_file</a> (1, p, 1);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>  }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>}</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span> </div>
<div class="ttc" id="acalc_8c_html_a16d22fb01d0c34406e63f5522d45ff34"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a16d22fb01d0c34406e63f5522d45ff34">field_question</a></div><div class="ttdeci">void field_question(gchar *question, GCallback handler, gpointer data)</div><div class="ttdoc">ask the use to confirm something</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00103">calc.c:103</a></div></div>
<div class="ttc" id="acalc_8c_html_a217a0b553ba8c460e7d5d251738016f3"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a217a0b553ba8c460e7d5d251738016f3">num_bonds</a></div><div class="ttdeci">int num_bonds(int i)</div><div class="ttdoc">number of distinct pair(s) of atoms in selection</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/selection_8c_source.html#l00183">selection.c:183</a></div></div>
<div class="ttc" id="acalc_8c_html_a2359ebc78207d2253ace4fb37f9451f6"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a2359ebc78207d2253ace4fb37f9451f6">qmbuffer</a></div><div class="ttdeci">GtkTextBuffer * qmbuffer[MAXDATAQM+2]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00070">calc.c:70</a></div></div>
<div class="ttc" id="acalc_8c_html_a2b204ad95d4a0de21e950d4550f7f4b4"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a2b204ad95d4a0de21e950d4550f7f4b4">MAXDATAQM</a></div><div class="ttdeci">#define MAXDATAQM</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00055">calc.c:55</a></div></div>
<div class="ttc" id="acalc_8c_html_a2e3daf14dd237159729f6868a7a2d3c6"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a2e3daf14dd237159729f6868a7a2d3c6">selection_confirmed</a></div><div class="ttdeci">gboolean selection_confirmed</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00077">calc.c:77</a></div></div>
<div class="ttc" id="acalc_8c_html_a2eae4a0d274b8690e6640f96b9c5d697"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a2eae4a0d274b8690e6640f96b9c5d697">duplicate_ogl_selection</a></div><div class="ttdeci">struct atom_selection * duplicate_ogl_selection(struct atom_selection *old_sel)</div><div class="ttdoc">copy an atom selection</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00119">calc.c:119</a></div></div>
<div class="ttc" id="acalc_8c_html_a4123d5a1dca7412136e98476b1fad428"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a4123d5a1dca7412136e98476b1fad428">unselect_all_atoms</a></div><div class="ttdeci">void unselect_all_atoms(glwin *view)</div><div class="ttdoc">remove all atom(s) from selection</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00182">calc.c:182</a></div></div>
<div class="ttc" id="acalc_8c_html_a50cfa2e27c94c14e4a51d42147319ba1"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a50cfa2e27c94c14e4a51d42147319ba1">confirm_selection</a></div><div class="ttdeci">G_MODULE_EXPORT void confirm_selection(GtkDialog *dialog, gint response_id, gpointer data)</div><div class="ttdoc">confirm that the selection is good</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00088">calc.c:88</a></div></div>
<div class="ttc" id="acalc_8c_html_a52e7dc3872878f8c40cd3523fed00c80"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a52e7dc3872878f8c40cd3523fed00c80">ident</a></div><div class="ttdeci">int ident</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00074">calc.c:74</a></div></div>
<div class="ttc" id="acalc_8c_html_a56dc4992a0fe143884bb1ac37e2ff029"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a56dc4992a0fe143884bb1ac37e2ff029">create_field</a></div><div class="ttdeci">G_MODULE_EXPORT void create_field(GtkWidget *widg, gpointer data)</div><div class="ttdoc">start an input creation assistant</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00308">calc.c:308</a></div></div>
<div class="ttc" id="acalc_8c_html_a5a8d46d83e58133452cb6922e6af24bc"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a5a8d46d83e58133452cb6922e6af24bc">qm_assistant</a></div><div class="ttdeci">GtkWidget * qm_assistant</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00066">calc.c:66</a></div></div>
<div class="ttc" id="acalc_8c_html_a65ff59350857daf2c84fac30688dc2a1"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a65ff59350857daf2c84fac30688dc2a1">force_mol</a></div><div class="ttdeci">gboolean force_mol</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00071">calc.c:71</a></div></div>
<div class="ttc" id="acalc_8c_html_a67589644451994ac2eb22ce3ba207444"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a67589644451994ac2eb22ce3ba207444">num_dihedrals</a></div><div class="ttdeci">int num_dihedrals(int i)</div><div class="ttdoc">number of distinct quadruplet(s) of atoms in selection</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/selection_8c_source.html#l00207">selection.c:207</a></div></div>
<div class="ttc" id="acalc_8c_html_a6eb9e6b6264fd2918d7d9d00c9c871aa"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a6eb9e6b6264fd2918d7d9d00c9c871aa">idopt</a></div><div class="ttdeci">int idopt</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00072">calc.c:72</a></div></div>
<div class="ttc" id="acalc_8c_html_a920ced75ee5e2a83a77e0c6dbd54c1a5"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a920ced75ee5e2a83a77e0c6dbd54c1a5">qm_view</a></div><div class="ttdeci">glwin * qm_view</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00068">calc.c:68</a></div></div>
<div class="ttc" id="acalc_8c_html_a94c2e02b8f44a8ec4db04e80f51fc91f"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a94c2e02b8f44a8ec4db04e80f51fc91f">input_types</a></div><div class="ttdeci">char * input_types[NINPUTS]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d51/m__tools_8c_source.html#l00071">m_tools.c:71</a></div></div>
<div class="ttc" id="acalc_8c_html_a9f622fc5c267b61dd72d0e26899933c9"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a9f622fc5c267b61dd72d0e26899933c9">restore_ogl_selection</a></div><div class="ttdeci">void restore_ogl_selection(glwin *view)</div><div class="ttdoc">restore a saved atom selection</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00218">calc.c:218</a></div></div>
<div class="ttc" id="acalc_8c_html_a9f9c174b2b52cd5d1073b6560c1dc649"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#a9f9c174b2b52cd5d1073b6560c1dc649">num_angles</a></div><div class="ttdeci">int num_angles(int i)</div><div class="ttdoc">number of distinct triplet(s) of atoms in selection</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/selection_8c_source.html#l00195">selection.c:195</a></div></div>
<div class="ttc" id="acalc_8c_html_aafa54525d9b45e8fa14617a65f4e1800"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#aafa54525d9b45e8fa14617a65f4e1800">new_selatom</a></div><div class="ttdeci">struct selatom * new_selatom(int id, int sp)</div><div class="ttdoc">create a selection atom</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/selection_8c_source.html#l00428">selection.c:428</a></div></div>
<div class="ttc" id="acalc_8c_html_abda3f5a20381278953e6f3e5ae1a2d0c"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#abda3f5a20381278953e6f3e5ae1a2d0c">qm_proj</a></div><div class="ttdeci">struct project * qm_proj</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00067">calc.c:67</a></div></div>
<div class="ttc" id="acalc_8c_html_ac8f82b4c47332a3ef876e2e89dd73b12"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#ac8f82b4c47332a3ef876e2e89dd73b12">create_qm_input_file</a></div><div class="ttdeci">void create_qm_input_file(int c, int p, int s)</div><div class="ttdoc">initialize an ab-initio MD input file creation assistant</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc0/cpmd__init_8c_source.html#l01567">cpmd_init.c:1567</a></div></div>
<div class="ttc" id="acalc_8c_html_acc2e12098220106492acfa228eb88db0"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#acc2e12098220106492acfa228eb88db0">create_classical_force_field</a></div><div class="ttdeci">void create_classical_force_field(int p, int f)</div><div class="ttdoc">create classical force field prepare the assistant</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d43/dlp__field_8c_source.html#l04672">dlp_field.c:4672</a></div></div>
<div class="ttc" id="acalc_8c_html_ad0285ff5ba77255c59eba4c6014edd8e"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#ad0285ff5ba77255c59eba4c6014edd8e">icomb</a></div><div class="ttdeci">int icomb</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00075">calc.c:75</a></div></div>
<div class="ttc" id="acalc_8c_html_ad1e0bfa9ca1b6c21c619081d65b0f289"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#ad1e0bfa9ca1b6c21c619081d65b0f289">create_new_project_using_data</a></div><div class="ttdeci">void create_new_project_using_data(struct atom_selection *selection)</div><div class="ttdoc">create new project using an atom selection</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da4/popup_8c_source.html#l02060">popup.c:2060</a></div></div>
<div class="ttc" id="acalc_8c_html_ad4719134658ac2407af687c7117e21af"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#ad4719134658ac2407af687c7117e21af">icalc</a></div><div class="ttdeci">int icalc</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00073">calc.c:73</a></div></div>
<div class="ttc" id="acalc_8c_html_ad81e8b625a603091b826af5886ca09e4"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#ad81e8b625a603091b826af5886ca09e4">selected_aspec</a></div><div class="ttdeci">int selected_aspec</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da4/popup_8c_source.html#l00179">popup.c:179</a></div></div>
<div class="ttc" id="acalc_8c_html_ad859a3e28c5f11c248cf9bfa24a8dd86"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#ad859a3e28c5f11c248cf9bfa24a8dd86">qm_coord</a></div><div class="ttdeci">coord_info * qm_coord</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00069">calc.c:69</a></div></div>
<div class="ttc" id="acalc_8c_html_ae182ab43129fb98cd2ee0592daf3dd0f"><div class="ttname"><a href="../../d1/dcc/calc_8c.html#ae182ab43129fb98cd2ee0592daf3dd0f">preserve_ogl_selection</a></div><div class="ttdeci">void preserve_ogl_selection(glwin *view)</div><div class="ttdoc">copy the atom selection, so that it can be re-used once the input assistant is closed.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dcc/calc_8c_source.html#l00264">calc.c:264</a></div></div>
<div class="ttc" id="acurve_8h_html_a6433eac9d33de4a4a94383373946a4db"><div class="ttname"><a href="../../df/de9/curve_8h.html#a6433eac9d33de4a4a94383373946a4db">label</a></div><div class="ttdeci">void label(cairo_t *cr, double val, int axe, int p, struct project *this_proj)</div><div class="ttdoc">draw axis label</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d87/labels_8c_source.html#l00056">labels.c:56</a></div></div>
<div class="ttc" id="ad__box_8c_html_a624f7fab23c51a3d6c022518130d5173"><div class="ttname"><a href="../../df/dbb/d__box_8c.html#a624f7fab23c51a3d6c022518130d5173">process_selected_atom</a></div><div class="ttdeci">void process_selected_atom(struct project *this_proj, glwin *view, int id, int ac, int se, int pi)</div><div class="ttdoc">process selected atom</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/selection_8c_source.html#l00514">selection.c:514</a></div></div>
<div class="ttc" id="ad__measures_8c_html_a2dcd3a3d62ba699dc89a04a938edf68e"><div class="ttname"><a href="../../df/dbb/d__measures_8c.html#a2dcd3a3d62ba699dc89a04a938edf68e">tmp_a</a></div><div class="ttdeci">struct selatom * tmp_a</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbb/d__measures_8c_source.html#l00069">d_measures.c:69</a></div></div>
<div class="ttc" id="ad__selection_8c_html_a00fd968c209562dd06305b96b8829715"><div class="ttname"><a href="../../d9/d09/d__selection_8c.html#a00fd968c209562dd06305b96b8829715">atoms</a></div><div class="ttdeci">int atoms[NUM_STYLES][2]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d09/d__selection_8c_source.html#l00361">d_selection.c:361</a></div></div>
<div class="ttc" id="adlp__atom_8c_html_ae7e90546f15170d3b995ba65ade46698"><div class="ttname"><a href="../../d2/da2/dlp__atom_8c.html#ae7e90546f15170d3b995ba65ade46698">init_default_shaders</a></div><div class="ttdeci">void init_default_shaders(glwin *view)</div><div class="ttdoc">re-initialize the default OpenGL shaders</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db9/ogl__shading_8c_source.html#l00729">ogl_shading.c:729</a></div></div>
<div class="ttc" id="aglobal_8c_html_a486cae79d3213edf7d5888ec50eef097"><div class="ttname"><a href="../../dc/d57/global_8c.html#a486cae79d3213edf7d5888ec50eef097">activep</a></div><div class="ttdeci">int activep</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d57/global_8c_source.html#l00220">global.c:220</a></div></div>
<div class="ttc" id="aglobal_8c_html_a860606c6c739700a56d9ef559ab4d3a1"><div class="ttname"><a href="../../dc/d57/global_8c.html#a860606c6c739700a56d9ef559ab4d3a1">activev</a></div><div class="ttdeci">int activev</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d57/global_8c_source.html#l00221">global.c:221</a></div></div>
<div class="ttc" id="aglobal_8c_html_aab70499bf07f4bcf8bea9073ac80ca69"><div class="ttname"><a href="../../dc/d57/global_8c.html#aab70499bf07f4bcf8bea9073ac80ca69">check_label</a></div><div class="ttdeci">gboolean check_label</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d57/global_8c_source.html#l00247">global.c:247</a></div></div>
<div class="ttc" id="aglobal_8c_html_aaf3f2fd944639e6fb28457da820d2d04"><div class="ttname"><a href="../../dc/d57/global_8c.html#aaf3f2fd944639e6fb28457da820d2d04">allocint</a></div><div class="ttdeci">int * allocint(int val)</div><div class="ttdoc">allocate an int * pointer</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d57/global_8c_source.html#l00387">global.c:387</a></div></div>
<div class="ttc" id="aglobal_8h_html"><div class="ttname"><a href="../../d2/d49/global_8h.html">global.h</a></div><div class="ttdoc">Global variable declarations   Global convenience function declarations   Global data structure defin...</div></div>
<div class="ttc" id="aglobal_8h_html_a03865a092347f44d492015e2d96e5c1b"><div class="ttname"><a href="../../d2/d49/global_8h.html#a03865a092347f44d492015e2d96e5c1b">run_this_gtk_dialog</a></div><div class="ttdeci">void run_this_gtk_dialog(GtkWidget *dial, GCallback handler, gpointer data)</div><div class="ttdoc">run a GTK (3 and 4) basic GtkDialog</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d90/gtk-misc_8c_source.html#l00475">gtk-misc.c:475</a></div></div>
<div class="ttc" id="aglobal_8h_html_a0ecd095d66ead4cfff3bca52e44c65d7"><div class="ttname"><a href="../../d2/d49/global_8h.html#a0ecd095d66ead4cfff3bca52e44c65d7">active_glwin</a></div><div class="ttdeci">glwin * active_glwin</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/project_8c_source.html#l00053">project.c:53</a></div></div>
<div class="ttc" id="aglobal_8h_html_a4f4f25a62fee0705bd9a89a784aa8fc8"><div class="ttname"><a href="../../d2/d49/global_8h.html#a4f4f25a62fee0705bd9a89a784aa8fc8">opengl_project_changed</a></div><div class="ttdeci">void opengl_project_changed(int id)</div><div class="ttdoc">change the OpenGL project</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d3e/update__p_8c_source.html#l00245">update_p.c:245</a></div></div>
<div class="ttc" id="aglobal_8h_html_a8c8175db540e27a12f44de526051712a"><div class="ttname"><a href="../../d2/d49/global_8h.html#a8c8175db540e27a12f44de526051712a">proj</a></div><div class="ttdeci">struct project * proj</div></div>
<div class="ttc" id="aglobal_8h_html_aa0b4d251cbb41cdbd3216119ee6ce397"><div class="ttname"><a href="../../d2/d49/global_8h.html#aa0b4d251cbb41cdbd3216119ee6ce397">opengl_project</a></div><div class="ttdeci">struct project * opengl_project</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/project_8c_source.html#l00054">project.c:54</a></div></div>
<div class="ttc" id="aglobal_8h_html_aa49ddc0195d8a595480dc10e720e0e60"><div class="ttname"><a href="../../d2/d49/global_8h.html#aa49ddc0195d8a595480dc10e720e0e60">destroy_this_dialog</a></div><div class="ttdeci">void destroy_this_dialog(GtkDialog *dialog)</div><div class="ttdoc">destroy a GtkDialog</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d90/gtk-misc_8c_source.html#l02044">gtk-misc.c:2044</a></div></div>
<div class="ttc" id="aglobal_8h_html_ab20acc15a1a5572b6a6d2ad176f82b96"><div class="ttname"><a href="../../d2/d49/global_8h.html#ab20acc15a1a5572b6a6d2ad176f82b96">select_unselect_atoms</a></div><div class="ttdeci">G_MODULE_EXPORT void select_unselect_atoms(GtkWidget *widg, gpointer data)</div><div class="ttdoc">select / unselect a type of atom(s) callback GTK3</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da4/popup_8c_source.html#l01550">popup.c:1550</a></div></div>
<div class="ttc" id="aglobal_8h_html_ab35a20e8b34f936e2eaf616b6108a25e"><div class="ttname"><a href="../../d2/d49/global_8h.html#ab35a20e8b34f936e2eaf616b6108a25e">get_project_by_id</a></div><div class="ttdeci">struct project * get_project_by_id(int p)</div><div class="ttdoc">get project pointer using id number</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/project_8c_source.html#l00120">project.c:120</a></div></div>
<div class="ttc" id="aglview_8c_html_a31439694040b6626b18b420754a6abf2"><div class="ttname"><a href="../../dc/d21/glview_8c.html#a31439694040b6626b18b420754a6abf2">update</a></div><div class="ttdeci">void update(glwin *view)</div><div class="ttdoc">update the rendering of the OpenGL window</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/glview_8c_source.html#l00439">glview.c:439</a></div></div>
<div class="ttc" id="aglview_8h_html"><div class="ttname"><a href="../../dc/de3/glview_8h.html">glview.h</a></div><div class="ttdoc">Variable declarations related to the OpenGL window   Function declaration related to the OpenGL windo...</div></div>
<div class="ttc" id="aglview_8h_html_a32c2baeed9056c3aafc347f660c812d0"><div class="ttname"><a href="../../dc/de3/glview_8h.html#a32c2baeed9056c3aafc347f660c812d0">MAX_IN_SELECTION</a></div><div class="ttdeci">#define MAX_IN_SELECTION</div><div class="ttdoc">Maximum number of atoms in selection to display measure information.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de3/glview_8h_source.html#l00135">glview.h:135</a></div></div>
<div class="ttc" id="aglview_8h_html_a3c30182e3bb8d86d14fdd648ad481bfb"><div class="ttname"><a href="../../dc/de3/glview_8h.html#a3c30182e3bb8d86d14fdd648ad481bfb">pick</a></div><div class="ttdeci">gboolean pick</div></div>
<div class="ttc" id="aglview_8h_html_a615938e6b20ee54bb89b04ee6cc7acfa"><div class="ttname"><a href="../../dc/de3/glview_8h.html#a615938e6b20ee54bb89b04ee6cc7acfa">check_label_numbers</a></div><div class="ttdeci">int check_label_numbers(struct project *this_proj, int types)</div><div class="ttdoc">check how many atom label(s) are visible</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da4/popup_8c_source.html#l01039">popup.c:1039</a></div></div>
<div class="ttc" id="aglview_8h_html_abc16e65f240ed0c8f3e876e8732c0a33"><div class="ttname"><a href="../../dc/de3/glview_8h.html#abc16e65f240ed0c8f3e876e8732c0a33">step</a></div><div class="ttdeci">int step</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db3/ogl__draw_8c_source.html#l00070">ogl_draw.c:70</a></div></div>
<div class="ttc" id="aglview_8h_html_ad68d7d512c6f9e7e01a70dff30be4458"><div class="ttname"><a href="../../dc/de3/glview_8h.html#ad68d7d512c6f9e7e01a70dff30be4458">update_all_selections</a></div><div class="ttdeci">void update_all_selections(glwin *view, int pi)</div><div class="ttdoc">update the selection data: bonds, angles and dihedrals</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/selection_8c_source.html#l00387">selection.c:387</a></div></div>
<div class="ttc" id="aglview_8h_html_ada5793f27b93c0470934ed5a59d072c0"><div class="ttname"><a href="../../dc/de3/glview_8h.html#ada5793f27b93c0470934ed5a59d072c0">save_all_selections</a></div><div class="ttdeci">void save_all_selections(glwin *view, int pi)</div><div class="ttdoc">save all selection data</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d50/selection_8c_source.html#l00372">selection.c:372</a></div></div>
<div class="ttc" id="aglwin_8h_html_ae244fd7da54cffb995fdf4c38a4213c0"><div class="ttname"><a href="../../da/d7e/glwin_8h.html#ae244fd7da54cffb995fdf4c38a4213c0">NINPUTS</a></div><div class="ttdeci">#define NINPUTS</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00068">glwin.h:68</a></div></div>
<div class="ttc" id="aglwindow_8h_html"><div class="ttname"><a href="../../d1/d2a/glwindow_8h.html">glwindow.h</a></div><div class="ttdoc">Function declarations for the creation of the OpenGL window.</div></div>
<div class="ttc" id="ainterface_8c_html_a17792c1207a0e96767342a0f8fce1d40"><div class="ttname"><a href="../../dd/dda/interface_8c.html#a17792c1207a0e96767342a0f8fce1d40">iask</a></div><div class="ttdeci">int iask(char *question, char *lab, int id, GtkWidget *win)</div><div class="ttdoc">enter an integer value - prepare the dialog</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dda/interface_8c_source.html#l00529">interface.c:529</a></div></div>
<div class="ttc" id="ainterface_8h_html"><div class="ttname"><a href="../../d4/da9/interface_8h.html">interface.h</a></div><div class="ttdoc">Messaging function declarations.</div></div>
<div class="ttc" id="aproject_8h_html"><div class="ttname"><a href="../../dc/d8d/project_8h.html">project.h</a></div><div class="ttdoc">Function declarations for reading atomes project file   Function declarations for saving atomes proje...</div></div>
<div class="ttc" id="aproject_8h_html_a81de550dd737cabebc1643a1e307ab8d"><div class="ttname"><a href="../../dc/d8d/project_8h.html#a81de550dd737cabebc1643a1e307ab8d">active_project_changed</a></div><div class="ttdeci">void active_project_changed(int id)</div><div class="ttdoc">change the active project</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d3e/update__p_8c_source.html#l00175">update_p.c:175</a></div></div>
<div class="ttc" id="astructatom__selection_html"><div class="ttname"><a href="../../d6/d0f/structatom__selection.html">atom_selection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00231">glwin.h:231</a></div></div>
<div class="ttc" id="astructatom__selection_html_a7c6d36b71454cf01697706b535082042"><div class="ttname"><a href="../../d6/d0f/structatom__selection.html#a7c6d36b71454cf01697706b535082042">atom_selection::selected_bonds</a></div><div class="ttdeci">int * selected_bonds</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00233">glwin.h:233</a></div></div>
<div class="ttc" id="astructatom__selection_html_a7f10a5b21c01156cc9686436860ab0bd"><div class="ttname"><a href="../../d6/d0f/structatom__selection.html#a7f10a5b21c01156cc9686436860ab0bd">atom_selection::selected_dihedrals</a></div><div class="ttdeci">int * selected_dihedrals</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00237">glwin.h:237</a></div></div>
<div class="ttc" id="astructatom__selection_html_aaa83eb55c4977fffe7dc968871c68191"><div class="ttname"><a href="../../d6/d0f/structatom__selection.html#aaa83eb55c4977fffe7dc968871c68191">atom_selection::first</a></div><div class="ttdeci">struct selatom * first</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00239">glwin.h:239</a></div></div>
<div class="ttc" id="astructatom__selection_html_adab4da51ba40d5a492becdceccccbfcd"><div class="ttname"><a href="../../d6/d0f/structatom__selection.html#adab4da51ba40d5a492becdceccccbfcd">atom_selection::selected</a></div><div class="ttdeci">int selected</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00232">glwin.h:232</a></div></div>
<div class="ttc" id="astructatom__selection_html_aed750c5384852e5de0e200c4b4b29c32"><div class="ttname"><a href="../../d6/d0f/structatom__selection.html#aed750c5384852e5de0e200c4b4b29c32">atom_selection::selected_angles</a></div><div class="ttdeci">int * selected_angles</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00235">glwin.h:235</a></div></div>
<div class="ttc" id="astructatom__selection_html_afc1615d6e57c873b3ee4eed3dd6ac117"><div class="ttname"><a href="../../d6/d0f/structatom__selection.html#afc1615d6e57c873b3ee4eed3dd6ac117">atom_selection::last</a></div><div class="ttdeci">struct selatom * last</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00240">glwin.h:240</a></div></div>
<div class="ttc" id="astructcoord__info_html"><div class="ttname"><a href="../../df/ddc/structcoord__info.html">coord_info</a></div><div class="ttdoc">Data structure to store coordination information.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00117">global.h:117</a></div></div>
<div class="ttc" id="astructglwin_html"><div class="ttname"><a href="../../d5/dd2/structglwin.html">glwin</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00806">glwin.h:806</a></div></div>
<div class="ttc" id="astructproject_html"><div class="ttname"><a href="../../dd/dbe/structproject.html">project</a></div><div class="ttdoc">The data structure for the 'atomes' project.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00823">global.h:823</a></div></div>
<div class="ttc" id="astructproject_html_a1123db0395a8a91840ac6fc353b15e48"><div class="ttname"><a href="../../dd/dbe/structproject.html#a1123db0395a8a91840ac6fc353b15e48">project::natomes</a></div><div class="ttdeci">int natomes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00837">global.h:837</a></div></div>
<div class="ttc" id="astructproject_html_a5ac083a645d964373f022d03df4849c8"><div class="ttname"><a href="../../dd/dbe/structproject.html#a5ac083a645d964373f022d03df4849c8">project::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00828">global.h:828</a></div></div>
<div class="ttc" id="astructproject_html_ab4ae7205573977222eadd0795db193e2"><div class="ttname"><a href="../../dd/dbe/structproject.html#ab4ae7205573977222eadd0795db193e2">project::steps</a></div><div class="ttdeci">int steps</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00839">global.h:839</a></div></div>
<div class="ttc" id="astructproject_html_aff9d071e0c309d1a7871e5277d86fed2"><div class="ttname"><a href="../../dd/dbe/structproject.html#aff9d071e0c309d1a7871e5277d86fed2">project::modelgl</a></div><div class="ttdeci">glwin * modelgl</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00901">global.h:901</a></div></div>
<div class="ttc" id="astructselatom_html"><div class="ttname"><a href="../../dd/d4c/structselatom.html">selatom</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00224">glwin.h:224</a></div></div>
<div class="ttc" id="astructselatom_html_a024603cda52d9847e8d8df3c2e884b8c"><div class="ttname"><a href="../../dd/d4c/structselatom.html#a024603cda52d9847e8d8df3c2e884b8c">selatom::sp</a></div><div class="ttdeci">int sp</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00226">glwin.h:226</a></div></div>
<div class="ttc" id="astructselatom_html_a10981207e30566ddf637f09719b237e4"><div class="ttname"><a href="../../dd/d4c/structselatom.html#a10981207e30566ddf637f09719b237e4">selatom::next</a></div><div class="ttdeci">struct selatom * next</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00228">glwin.h:228</a></div></div>
<div class="ttc" id="astructselatom_html_a7441ef0865bcb3db9b8064dd7375c1ea"><div class="ttname"><a href="../../dd/d4c/structselatom.html#a7441ef0865bcb3db9b8064dd7375c1ea">selatom::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7e/glwin_8h_source.html#l00225">glwin.h:225</a></div></div>
<div class="ttc" id="astructtint_html"><div class="ttname"><a href="../../df/d46/structtint.html">tint</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00094">global.h:94</a></div></div>
<div class="ttc" id="astructtint_html_a148e3876077787926724625411d6e7a9"><div class="ttname"><a href="../../df/d46/structtint.html#a148e3876077787926724625411d6e7a9">tint::b</a></div><div class="ttdeci">int b</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00096">global.h:96</a></div></div>
<div class="ttc" id="astructtint_html_a4e1e0e72dd773439e333c84dd762a9c3"><div class="ttname"><a href="../../df/d46/structtint.html#a4e1e0e72dd773439e333c84dd762a9c3">tint::c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00097">global.h:97</a></div></div>
<div class="ttc" id="astructtint_html_aa4c2a5552e9bc49b1816ff532f558c74"><div class="ttname"><a href="../../df/d46/structtint.html#aa4c2a5552e9bc49b1816ff532f558c74">tint::a</a></div><div class="ttdeci">int a</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d49/global_8h_source.html#l00095">global.h:95</a></div></div>
<div class="ttc" id="atab-1_8c_html_a148e3876077787926724625411d6e7a9"><div class="ttname"><a href="../../df/df7/tab-1_8c.html#a148e3876077787926724625411d6e7a9">b</a></div><div class="ttdeci">int b</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df7/tab-1_8c_source.html#l00095">tab-1.c:95</a></div></div>
<div class="ttc" id="atab-1_8c_html_a4e1e0e72dd773439e333c84dd762a9c3"><div class="ttname"><a href="../../df/df7/tab-1_8c.html#a4e1e0e72dd773439e333c84dd762a9c3">c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df7/tab-1_8c_source.html#l00095">tab-1.c:95</a></div></div>
<div class="ttc" id="atab-1_8c_html_aa4c2a5552e9bc49b1816ff532f558c74"><div class="ttname"><a href="../../df/df7/tab-1_8c.html#aa4c2a5552e9bc49b1816ff532f558c74">a</a></div><div class="ttdeci">int a</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df7/tab-1_8c_source.html#l00095">tab-1.c:95</a></div></div>
<div class="ttc" id="aworkspace_8c_html_a37614206af3ba4a550903b6a67db76da"><div class="ttname"><a href="../../d3/da6/workspace_8c.html#a37614206af3ba4a550903b6a67db76da">img</a></div><div class="ttdeci">GtkWidget * img</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da6/workspace_8c_source.html#l00070">workspace.c:70</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b23ce9843a0cf83641620a63d26b700d.html">calc</a></li><li class="navelem"><a class="el" href="../../d1/dcc/calc_8c.html">calc.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
